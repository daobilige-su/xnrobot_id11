% Compute the error of a pose-landmark constraint
% x 3x1 vector (x,y,theta) of the robot pose
% l 2x1 vector (x,y) of the landmark
% z 2x1 vector (x,y) of the measurement, the position of the landmark in
%   the coordinate frame of the robot given by the vector x
%
% Output
% e 2x1 error of the constraint
% A 2x3 Jacobian wrt x
% B 2x2 Jacobian wrt l
function [e, A, B] = linearize_pose_landmark_constraint_2d(x, l, z)

  % TODO compute the error and the Jacobians of the error
   
  % error
  %M_p = v2t(x);

  %l_local = v2t(x)\[l;1];
  %e = atan2(l_local(2),l_local(1))-z;

  l_local = v2t(x)\[l;1];
  l_theta = atan2(l_local(2),l_local(1));

  e_t = t2v(v2t([0;0;z])'*v2t([0;0;l_theta]));
  e = e_t(3);

  p_x = x(1);
  p_y = x(2);
  p_theta = x(3);

  l_x = l(1);
  l_y = l(2);

  z_theta = z;
  
  % computation of A, de/dx1, x1 here is landmark
  %A = [-(l(2)-x(2))/((l(2)-x(2))^2+(l(1)-x(1))^2),+(l(1)-x(1))/((l(2)-x(2))^2+(l(1)-x(1))^2)];
  A = [ -((((cos(p_theta)*sin(z_theta))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) + (cos(z_theta)*sin(p_theta))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) + (sign(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta))*cos(z_theta)*(cos(p_theta) - sin(p_theta)*1i)*(l_y*cos(p_theta) - p_y*cos(p_theta) - l_x*sin(p_theta) + p_x*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) + p_y*cos(p_theta)*(-1i) + l_x*sin(p_theta)*(-1i)  + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta))^2 - (sign(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta))*sin(z_theta)*(cos(p_theta) - sin(p_theta)*1i)*(l_x*cos(p_theta) - p_x*cos(p_theta) + l_y*sin(p_theta) - p_y*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) + p_y*cos(p_theta)*(-1i)  + l_x*sin(p_theta)*(-1i) + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta))^2)/((cos(z_theta)*(l_x*cos(p_theta) - p_x*cos(p_theta) + l_y*sin(p_theta) - p_y*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) + (sin(z_theta)*(l_y*cos(p_theta) - p_y*cos(p_theta) - l_x*sin(p_theta) + p_x*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta))) - (((cos(z_theta)*(l_y*cos(p_theta) - p_y*cos(p_theta) - l_x*sin(p_theta) + p_x*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) - (sin(z_theta)*(l_x*cos(p_theta) - p_x*cos(p_theta) + l_y*sin(p_theta) - p_y*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)))*((sin(p_theta)*sin(z_theta))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) - (cos(p_theta)*cos(z_theta))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) + (sign(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta))*cos(z_theta)*(cos(p_theta) - sin(p_theta)*1i)*(l_x*cos(p_theta) - p_x*cos(p_theta) + l_y*sin(p_theta) - p_y*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) + p_y*cos(p_theta)*(-1i)  + l_x*sin(p_theta)*(-1i)  + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta))^2 + (sign(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta))*sin(z_theta)*(cos(p_theta) - sin(p_theta)*1i)*(l_y*cos(p_theta) - p_y*cos(p_theta) - l_x*sin(p_theta) + p_x*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) + p_y*cos(p_theta)*(-1i)  + l_x*sin(p_theta)*(-1i)  + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta))^2))/((cos(z_theta)*(l_x*cos(p_theta) - p_x*cos(p_theta) + l_y*sin(p_theta) - p_y*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) + p_y*cos(p_theta)*(-1i)  + l_x*sin(p_theta)*(-1i)  + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) + (sin(z_theta)*(l_y*cos(p_theta) - p_y*cos(p_theta) - l_x*sin(p_theta) + p_x*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) + p_y*cos(p_theta)*(-1i)  + l_x*sin(p_theta)*(-1i)  + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)))^2)*((cos(z_theta)*(l_x*cos(p_theta) - p_x*cos(p_theta) + l_y*sin(p_theta) - p_y*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) + (sin(z_theta)*(l_y*cos(p_theta) - p_y*cos(p_theta) - l_x*sin(p_theta) + p_x*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)))^2)/(((cos(z_theta)*(l_x*cos(p_theta) - p_x*cos(p_theta) + l_y*sin(p_theta) - p_y*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) + (sin(z_theta)*(l_y*cos(p_theta) - p_y*cos(p_theta) - l_x*sin(p_theta) + p_x*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)))^2 + ((cos(z_theta)*(l_y*cos(p_theta) - p_y*cos(p_theta) - l_x*sin(p_theta) + p_x*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) - (sin(z_theta)*(l_x*cos(p_theta) - p_x*cos(p_theta) + l_y*sin(p_theta) - p_y*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)))^2), ((((cos(p_theta)*cos(z_theta))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) - (sin(p_theta)*sin(z_theta))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) - (sign(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta))*cos(z_theta)*(cos(p_theta)*1i + sin(p_theta))*(l_y*cos(p_theta) - p_y*cos(p_theta) - l_x*sin(p_theta) + p_x*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) + p_y*cos(p_theta)*(-1i)  + l_x*sin(p_theta)*(-1i)  + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta))^2 + (sign(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta))*sin(z_theta)*(cos(p_theta)*1i + sin(p_theta))*(l_x*cos(p_theta) - p_x*cos(p_theta) + l_y*sin(p_theta) - p_y*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) + p_y*cos(p_theta)*(-1i)  + l_x*sin(p_theta)*(-1i)  + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta))^2)/((cos(z_theta)*(l_x*cos(p_theta) - p_x*cos(p_theta) + l_y*sin(p_theta) - p_y*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) + (sin(z_theta)*(l_y*cos(p_theta) - p_y*cos(p_theta) - l_x*sin(p_theta) + p_x*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta))) - (((cos(z_theta)*(l_y*cos(p_theta) - p_y*cos(p_theta) - l_x*sin(p_theta) + p_x*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) - (sin(z_theta)*(l_x*cos(p_theta) - p_x*cos(p_theta) + l_y*sin(p_theta) - p_y*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)))*((cos(p_theta)*sin(z_theta))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) + (cos(z_theta)*sin(p_theta))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) - (sign(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta))*cos(z_theta)*(cos(p_theta)*1i + sin(p_theta))*(l_x*cos(p_theta) - p_x*cos(p_theta) + l_y*sin(p_theta) - p_y*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) + p_y*cos(p_theta)*(-1i)  + l_x*sin(p_theta)*(-1i)  + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta))^2 - (sign(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta))*sin(z_theta)*(cos(p_theta)*1i + sin(p_theta))*(l_y*cos(p_theta) - p_y*cos(p_theta) - l_x*sin(p_theta) + p_x*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) + p_y*cos(p_theta)*(-1i)  + l_x*sin(p_theta)*(-1i)  + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta))^2))/((cos(z_theta)*(l_x*cos(p_theta) - p_x*cos(p_theta) + l_y*sin(p_theta) - p_y*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) + p_y*cos(p_theta)*(-1i)  + l_x*sin(p_theta)*(-1i)  + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) + (sin(z_theta)*(l_y*cos(p_theta) - p_y*cos(p_theta) - l_x*sin(p_theta) + p_x*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) + p_y*cos(p_theta)*(-1i)  + l_x*sin(p_theta)*(-1i)  + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)))^2)*((cos(z_theta)*(l_x*cos(p_theta) - p_x*cos(p_theta) + l_y*sin(p_theta) - p_y*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) + (sin(z_theta)*(l_y*cos(p_theta) - p_y*cos(p_theta) - l_x*sin(p_theta) + p_x*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)))^2)/(((cos(z_theta)*(l_x*cos(p_theta) - p_x*cos(p_theta) + l_y*sin(p_theta) - p_y*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) + (sin(z_theta)*(l_y*cos(p_theta) - p_y*cos(p_theta) - l_x*sin(p_theta) + p_x*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)))^2 + ((cos(z_theta)*(l_y*cos(p_theta) - p_y*cos(p_theta) - l_x*sin(p_theta) + p_x*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) - (sin(z_theta)*(l_x*cos(p_theta) - p_x*cos(p_theta) + l_y*sin(p_theta) - p_y*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)))^2)];

  % computation of B, de/dx2, x2 here is robot pose
  B = [ ((((cos(p_theta)*sin(z_theta))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) + (cos(z_theta)*sin(p_theta))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) + (sign(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta))*cos(z_theta)*(cos(p_theta) - sin(p_theta)*1i )*(l_y*cos(p_theta) - p_y*cos(p_theta) - l_x*sin(p_theta) + p_x*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) + p_y*cos(p_theta)*(-1i)  + l_x*sin(p_theta)*(-1i)  + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta))^2 - (sign(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta))*sin(z_theta)*(cos(p_theta) - sin(p_theta)*1i )*(l_x*cos(p_theta) - p_x*cos(p_theta) + l_y*sin(p_theta) - p_y*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) + p_y*cos(p_theta)*(-1i)  + l_x*sin(p_theta)*(-1i)  + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta))^2)/((cos(z_theta)*(l_x*cos(p_theta) - p_x*cos(p_theta) + l_y*sin(p_theta) - p_y*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) + (sin(z_theta)*(l_y*cos(p_theta) - p_y*cos(p_theta) - l_x*sin(p_theta) + p_x*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta))) - (((cos(z_theta)*(l_y*cos(p_theta) - p_y*cos(p_theta) - l_x*sin(p_theta) + p_x*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) - (sin(z_theta)*(l_x*cos(p_theta) - p_x*cos(p_theta) + l_y*sin(p_theta) - p_y*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)))*((sin(p_theta)*sin(z_theta))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) - (cos(p_theta)*cos(z_theta))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) + (sign(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta))*cos(z_theta)*(cos(p_theta) - sin(p_theta)*1i )*(l_x*cos(p_theta) - p_x*cos(p_theta) + l_y*sin(p_theta) - p_y*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) + p_y*cos(p_theta)*(-1i)  + l_x*sin(p_theta)*(-1i)  + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta))^2 + (sign(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta))*sin(z_theta)*(cos(p_theta) - sin(p_theta)*1i)*(l_y*cos(p_theta) - p_y*cos(p_theta) - l_x*sin(p_theta) + p_x*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) + p_y*cos(p_theta)*(-1i)  + l_x*sin(p_theta)*(-1i) + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta))^2))/((cos(z_theta)*(l_x*cos(p_theta) - p_x*cos(p_theta) + l_y*sin(p_theta) - p_y*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) + p_y*cos(p_theta)*(-1i)  + l_x*sin(p_theta)*(-1i)  + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) + (sin(z_theta)*(l_y*cos(p_theta) - p_y*cos(p_theta) - l_x*sin(p_theta) + p_x*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) + p_y*cos(p_theta)*(-1i)  + l_x*sin(p_theta)*(-1i)  + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)))^2)*((cos(z_theta)*(l_x*cos(p_theta) - p_x*cos(p_theta) + l_y*sin(p_theta) - p_y*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) + (sin(z_theta)*(l_y*cos(p_theta) - p_y*cos(p_theta) - l_x*sin(p_theta) + p_x*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)))^2)/(((cos(z_theta)*(l_x*cos(p_theta) - p_x*cos(p_theta) + l_y*sin(p_theta) - p_y*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) + (sin(z_theta)*(l_y*cos(p_theta) - p_y*cos(p_theta) - l_x*sin(p_theta) + p_x*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)))^2 + ((cos(z_theta)*(l_y*cos(p_theta) - p_y*cos(p_theta) - l_x*sin(p_theta) + p_x*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) - (sin(z_theta)*(l_x*cos(p_theta) - p_x*cos(p_theta) + l_y*sin(p_theta) - p_y*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)))^2), -((((cos(p_theta)*cos(z_theta))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) - (sin(p_theta)*sin(z_theta))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) - (sign(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta))*cos(z_theta)*(cos(p_theta)*1i + sin(p_theta))*(l_y*cos(p_theta) - p_y*cos(p_theta) - l_x*sin(p_theta) + p_x*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) + p_y*cos(p_theta)*(-1i)  + l_x*sin(p_theta)*(-1i)  + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta))^2 + (sign(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta))*sin(z_theta)*(cos(p_theta)*1i + sin(p_theta))*(l_x*cos(p_theta) - p_x*cos(p_theta) + l_y*sin(p_theta) - p_y*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) + p_y*cos(p_theta)*(-1i)  + l_x*sin(p_theta)*(-1i)  + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta))^2)/((cos(z_theta)*(l_x*cos(p_theta) - p_x*cos(p_theta) + l_y*sin(p_theta) - p_y*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) + (sin(z_theta)*(l_y*cos(p_theta) - p_y*cos(p_theta) - l_x*sin(p_theta) + p_x*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta))) - (((cos(z_theta)*(l_y*cos(p_theta) - p_y*cos(p_theta) - l_x*sin(p_theta) + p_x*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) - (sin(z_theta)*(l_x*cos(p_theta) - p_x*cos(p_theta) + l_y*sin(p_theta) - p_y*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)))*((cos(p_theta)*sin(z_theta))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) + (cos(z_theta)*sin(p_theta))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) - (sign(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta))*cos(z_theta)*(cos(p_theta)*1i + sin(p_theta))*(l_x*cos(p_theta) - p_x*cos(p_theta) + l_y*sin(p_theta) - p_y*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) + p_y*cos(p_theta)*(-1i)  + l_x*sin(p_theta)*(-1i)  + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta))^2 - (sign(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta))*sin(z_theta)*(cos(p_theta)*1i + sin(p_theta))*(l_y*cos(p_theta) - p_y*cos(p_theta) - l_x*sin(p_theta) + p_x*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) + p_y*cos(p_theta)*(-1i)  + l_x*sin(p_theta)*(-1i)  + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta))^2))/((cos(z_theta)*(l_x*cos(p_theta) - p_x*cos(p_theta) + l_y*sin(p_theta) - p_y*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) + p_y*cos(p_theta)*(-1i)  + l_x*sin(p_theta)*(-1i)  + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) + (sin(z_theta)*(l_y*cos(p_theta) - p_y*cos(p_theta) - l_x*sin(p_theta) + p_x*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) + p_y*cos(p_theta)*(-1i)  + l_x*sin(p_theta)*(-1i)  + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)))^2)*((cos(z_theta)*(l_x*cos(p_theta) - p_x*cos(p_theta) + l_y*sin(p_theta) - p_y*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) + (sin(z_theta)*(l_y*cos(p_theta) - p_y*cos(p_theta) - l_x*sin(p_theta) + p_x*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)))^2)/(((cos(z_theta)*(l_x*cos(p_theta) - p_x*cos(p_theta) + l_y*sin(p_theta) - p_y*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) + (sin(z_theta)*(l_y*cos(p_theta) - p_y*cos(p_theta) - l_x*sin(p_theta) + p_x*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)))^2 + ((cos(z_theta)*(l_y*cos(p_theta) - p_y*cos(p_theta) - l_x*sin(p_theta) + p_x*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) - (sin(z_theta)*(l_x*cos(p_theta) - p_x*cos(p_theta) + l_y*sin(p_theta) - p_y*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)))^2), -(((cos(z_theta)*(l_x*cos(p_theta) - p_x*cos(p_theta) + l_y*sin(p_theta) - p_y*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) + (sin(z_theta)*(l_y*cos(p_theta) - p_y*cos(p_theta) - l_x*sin(p_theta) + p_x*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)))^2*(((cos(z_theta)*(l_x*cos(p_theta) - p_x*cos(p_theta) + l_y*sin(p_theta) - p_y*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) + (sin(z_theta)*(l_y*cos(p_theta) - p_y*cos(p_theta) - l_x*sin(p_theta) + p_x*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) - (sign(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta))*cos(z_theta)*(l_y*cos(p_theta) - p_y*cos(p_theta) - l_x*sin(p_theta) + p_x*sin(p_theta))*(l_x*cos(p_theta)*1i - l_y*cos(p_theta) - p_x*cos(p_theta)*1i + p_y*cos(p_theta) + l_x*sin(p_theta) + l_y*sin(p_theta)*1i - p_x*sin(p_theta) - p_y*sin(p_theta)*1i ))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) + p_y*cos(p_theta)*(-1i)  + l_x*sin(p_theta)*(-1i)  + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta))^2 + (sign(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta))*sin(z_theta)*(l_x*cos(p_theta) - p_x*cos(p_theta) + l_y*sin(p_theta) - p_y*sin(p_theta))*(l_x*cos(p_theta)*1i - l_y*cos(p_theta) - p_x*cos(p_theta)*1i + p_y*cos(p_theta) + l_x*sin(p_theta) + l_y*sin(p_theta)*1i - p_x*sin(p_theta) - p_y*sin(p_theta)*1i ))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) + p_y*cos(p_theta)*(-1i)  + l_x*sin(p_theta)*(-1i)  + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta))^2)/((cos(z_theta)*(l_x*cos(p_theta) - p_x*cos(p_theta) + l_y*sin(p_theta) - p_y*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) + (sin(z_theta)*(l_y*cos(p_theta) - p_y*cos(p_theta) - l_x*sin(p_theta) + p_x*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta))) + (((cos(z_theta)*(l_y*cos(p_theta) - p_y*cos(p_theta) - l_x*sin(p_theta) + p_x*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) - (sin(z_theta)*(l_x*cos(p_theta) - p_x*cos(p_theta) + l_y*sin(p_theta) - p_y*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)))*((cos(z_theta)*(l_y*cos(p_theta) - p_y*cos(p_theta) - l_x*sin(p_theta) + p_x*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) - (sin(z_theta)*(l_x*cos(p_theta) - p_x*cos(p_theta) + l_y*sin(p_theta) - p_y*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) + (sign(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta))*cos(z_theta)*(l_x*cos(p_theta) - p_x*cos(p_theta) + l_y*sin(p_theta) - p_y*sin(p_theta))*(l_x*cos(p_theta)*1i - l_y*cos(p_theta) - p_x*cos(p_theta)*1i + p_y*cos(p_theta) + l_x*sin(p_theta) + l_y*sin(p_theta)*1i - p_x*sin(p_theta) - p_y*sin(p_theta)*1i ))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) + p_y*cos(p_theta)*(-1i)  + l_x*sin(p_theta)*(-1i)  + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta))^2 + (sign(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta))*sin(z_theta)*(l_y*cos(p_theta) - p_y*cos(p_theta) - l_x*sin(p_theta) + p_x*sin(p_theta))*(l_x*cos(p_theta)*1i - l_y*cos(p_theta) - p_x*cos(p_theta)*1i + p_y*cos(p_theta) + l_x*sin(p_theta) + l_y*sin(p_theta)*1i - p_x*sin(p_theta) - p_y*sin(p_theta)*1i ))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) + p_y*cos(p_theta)*(-1i)  + l_x*sin(p_theta)*(-1i)  + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta))^2))/((cos(z_theta)*(l_x*cos(p_theta) - p_x*cos(p_theta) + l_y*sin(p_theta) - p_y*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) + p_y*cos(p_theta)*(-1i)  + l_x*sin(p_theta)*(-1i)  + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) + (sin(z_theta)*(l_y*cos(p_theta) - p_y*cos(p_theta) - l_x*sin(p_theta) + p_x*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) + p_y*cos(p_theta)*(-1i)  + l_x*sin(p_theta)*(-1i)  + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)))^2))/(((cos(z_theta)*(l_x*cos(p_theta) - p_x*cos(p_theta) + l_y*sin(p_theta) - p_y*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) + (sin(z_theta)*(l_y*cos(p_theta) - p_y*cos(p_theta) - l_x*sin(p_theta) + p_x*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)))^2 + ((cos(z_theta)*(l_y*cos(p_theta) - p_y*cos(p_theta) - l_x*sin(p_theta) + p_x*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)) - (sin(z_theta)*(l_x*cos(p_theta) - p_x*cos(p_theta) + l_y*sin(p_theta) - p_y*sin(p_theta)))/abs(l_x*cos(p_theta) + l_y*cos(p_theta)*1i - p_x*cos(p_theta) - p_y*cos(p_theta)*1i - l_x*sin(p_theta)*1i + l_y*sin(p_theta) + p_x*sin(p_theta)*1i - p_y*sin(p_theta)))^2)];
  
  A = real(A);
  B = real(B);
  
end
