function [A,B,C] = jacobian_pose_landmark_constraint_2d(x,l,anchor)

p_x = x(1);
p_y = x(2);
p_theta = x(3);

l_theta = l(1);
l_idp = l(2);

an_x = anchor(1);
an_y = anchor(2);
an_theta = anchor(3);

A = [ (((cos(l_theta)*cos(p_theta) + sin(l_theta)*sin(p_theta))/(cos(l_theta)*cos(p_theta) + sin(l_theta)*sin(p_theta) + an_x*l_idp*cos(p_theta) - l_idp*p_x*cos(p_theta) + an_y*l_idp*sin(p_theta) - l_idp*p_y*sin(p_theta)) + ((cos(l_theta)*sin(p_theta) - cos(p_theta)*sin(l_theta))*(cos(l_theta)*sin(p_theta) - cos(p_theta)*sin(l_theta) - an_y*l_idp*cos(p_theta) + l_idp*p_y*cos(p_theta) + an_x*l_idp*sin(p_theta) - l_idp*p_x*sin(p_theta)))/(cos(l_theta)*cos(p_theta) + sin(l_theta)*sin(p_theta) + an_x*l_idp*cos(p_theta) - l_idp*p_x*cos(p_theta) + an_y*l_idp*sin(p_theta) - l_idp*p_y*sin(p_theta))^2)*(cos(l_theta)*cos(p_theta) + sin(l_theta)*sin(p_theta) + an_x*l_idp*cos(p_theta) - l_idp*p_x*cos(p_theta) + an_y*l_idp*sin(p_theta) - l_idp*p_y*sin(p_theta))^2)/(l_idp^2*((cos(l_theta)*cos(p_theta) + sin(l_theta)*sin(p_theta) + an_x*l_idp*cos(p_theta) - l_idp*p_x*cos(p_theta) + an_y*l_idp*sin(p_theta) - l_idp*p_y*sin(p_theta))^2/(l_idp^2*(cos(p_theta)^2 + sin(p_theta)^2)^2) + (cos(l_theta)*sin(p_theta) - cos(p_theta)*sin(l_theta) - an_y*l_idp*cos(p_theta) + l_idp*p_y*cos(p_theta) + an_x*l_idp*sin(p_theta) - l_idp*p_x*sin(p_theta))^2/(l_idp^2*(cos(p_theta)^2 + sin(p_theta)^2)^2))*(cos(p_theta)^2 + sin(p_theta)^2)^2), (((an_y*cos(p_theta) - p_y*cos(p_theta) - an_x*sin(p_theta) + p_x*sin(p_theta))/(cos(l_theta)*cos(p_theta) + sin(l_theta)*sin(p_theta) + an_x*l_idp*cos(p_theta) - l_idp*p_x*cos(p_theta) + an_y*l_idp*sin(p_theta) - l_idp*p_y*sin(p_theta)) + ((an_x*cos(p_theta) - p_x*cos(p_theta) + an_y*sin(p_theta) - p_y*sin(p_theta))*(cos(l_theta)*sin(p_theta) - cos(p_theta)*sin(l_theta) - an_y*l_idp*cos(p_theta) + l_idp*p_y*cos(p_theta) + an_x*l_idp*sin(p_theta) - l_idp*p_x*sin(p_theta)))/(cos(l_theta)*cos(p_theta) + sin(l_theta)*sin(p_theta) + an_x*l_idp*cos(p_theta) - l_idp*p_x*cos(p_theta) + an_y*l_idp*sin(p_theta) - l_idp*p_y*sin(p_theta))^2)*(cos(l_theta)*cos(p_theta) + sin(l_theta)*sin(p_theta) + an_x*l_idp*cos(p_theta) - l_idp*p_x*cos(p_theta) + an_y*l_idp*sin(p_theta) - l_idp*p_y*sin(p_theta))^2)/(l_idp^2*((cos(l_theta)*cos(p_theta) + sin(l_theta)*sin(p_theta) + an_x*l_idp*cos(p_theta) - l_idp*p_x*cos(p_theta) + an_y*l_idp*sin(p_theta) - l_idp*p_y*sin(p_theta))^2/(l_idp^2*(cos(p_theta)^2 + sin(p_theta)^2)^2) + (cos(l_theta)*sin(p_theta) - cos(p_theta)*sin(l_theta) - an_y*l_idp*cos(p_theta) + l_idp*p_y*cos(p_theta) + an_x*l_idp*sin(p_theta) - l_idp*p_x*sin(p_theta))^2/(l_idp^2*(cos(p_theta)^2 + sin(p_theta)^2)^2))*(cos(p_theta)^2 + sin(p_theta)^2)^2)];

B = [ (((l_idp*sin(p_theta))/(cos(l_theta)*cos(p_theta) + sin(l_theta)*sin(p_theta) + an_x*l_idp*cos(p_theta) - l_idp*p_x*cos(p_theta) + an_y*l_idp*sin(p_theta) - l_idp*p_y*sin(p_theta)) - (l_idp*cos(p_theta)*(cos(l_theta)*sin(p_theta) - cos(p_theta)*sin(l_theta) - an_y*l_idp*cos(p_theta) + l_idp*p_y*cos(p_theta) + an_x*l_idp*sin(p_theta) - l_idp*p_x*sin(p_theta)))/(cos(l_theta)*cos(p_theta) + sin(l_theta)*sin(p_theta) + an_x*l_idp*cos(p_theta) - l_idp*p_x*cos(p_theta) + an_y*l_idp*sin(p_theta) - l_idp*p_y*sin(p_theta))^2)*(cos(l_theta)*cos(p_theta) + sin(l_theta)*sin(p_theta) + an_x*l_idp*cos(p_theta) - l_idp*p_x*cos(p_theta) + an_y*l_idp*sin(p_theta) - l_idp*p_y*sin(p_theta))^2)/(l_idp^2*((cos(l_theta)*cos(p_theta) + sin(l_theta)*sin(p_theta) + an_x*l_idp*cos(p_theta) - l_idp*p_x*cos(p_theta) + an_y*l_idp*sin(p_theta) - l_idp*p_y*sin(p_theta))^2/(l_idp^2*(cos(p_theta)^2 + sin(p_theta)^2)^2) + (cos(l_theta)*sin(p_theta) - cos(p_theta)*sin(l_theta) - an_y*l_idp*cos(p_theta) + l_idp*p_y*cos(p_theta) + an_x*l_idp*sin(p_theta) - l_idp*p_x*sin(p_theta))^2/(l_idp^2*(cos(p_theta)^2 + sin(p_theta)^2)^2))*(cos(p_theta)^2 + sin(p_theta)^2)^2), -(((l_idp*cos(p_theta))/(cos(l_theta)*cos(p_theta) + sin(l_theta)*sin(p_theta) + an_x*l_idp*cos(p_theta) - l_idp*p_x*cos(p_theta) + an_y*l_idp*sin(p_theta) - l_idp*p_y*sin(p_theta)) + (l_idp*sin(p_theta)*(cos(l_theta)*sin(p_theta) - cos(p_theta)*sin(l_theta) - an_y*l_idp*cos(p_theta) + l_idp*p_y*cos(p_theta) + an_x*l_idp*sin(p_theta) - l_idp*p_x*sin(p_theta)))/(cos(l_theta)*cos(p_theta) + sin(l_theta)*sin(p_theta) + an_x*l_idp*cos(p_theta) - l_idp*p_x*cos(p_theta) + an_y*l_idp*sin(p_theta) - l_idp*p_y*sin(p_theta))^2)*(cos(l_theta)*cos(p_theta) + sin(l_theta)*sin(p_theta) + an_x*l_idp*cos(p_theta) - l_idp*p_x*cos(p_theta) + an_y*l_idp*sin(p_theta) - l_idp*p_y*sin(p_theta))^2)/(l_idp^2*((cos(l_theta)*cos(p_theta) + sin(l_theta)*sin(p_theta) + an_x*l_idp*cos(p_theta) - l_idp*p_x*cos(p_theta) + an_y*l_idp*sin(p_theta) - l_idp*p_y*sin(p_theta))^2/(l_idp^2*(cos(p_theta)^2 + sin(p_theta)^2)^2) + (cos(l_theta)*sin(p_theta) - cos(p_theta)*sin(l_theta) - an_y*l_idp*cos(p_theta) + l_idp*p_y*cos(p_theta) + an_x*l_idp*sin(p_theta) - l_idp*p_x*sin(p_theta))^2/(l_idp^2*(cos(p_theta)^2 + sin(p_theta)^2)^2))*(cos(p_theta)^2 + sin(p_theta)^2)^2), -(((cos(l_theta)*sin(p_theta) - cos(p_theta)*sin(l_theta) - an_y*l_idp*cos(p_theta) + l_idp*p_y*cos(p_theta) + an_x*l_idp*sin(p_theta) - l_idp*p_x*sin(p_theta))^2/(cos(l_theta)*cos(p_theta) + sin(l_theta)*sin(p_theta) + an_x*l_idp*cos(p_theta) - l_idp*p_x*cos(p_theta) + an_y*l_idp*sin(p_theta) - l_idp*p_y*sin(p_theta))^2 + 1)*(cos(l_theta)*cos(p_theta) + sin(l_theta)*sin(p_theta) + an_x*l_idp*cos(p_theta) - l_idp*p_x*cos(p_theta) + an_y*l_idp*sin(p_theta) - l_idp*p_y*sin(p_theta))^2)/(l_idp^2*((cos(l_theta)*cos(p_theta) + sin(l_theta)*sin(p_theta) + an_x*l_idp*cos(p_theta) - l_idp*p_x*cos(p_theta) + an_y*l_idp*sin(p_theta) - l_idp*p_y*sin(p_theta))^2/(l_idp^2*(cos(p_theta)^2 + sin(p_theta)^2)^2) + (cos(l_theta)*sin(p_theta) - cos(p_theta)*sin(l_theta) - an_y*l_idp*cos(p_theta) + l_idp*p_y*cos(p_theta) + an_x*l_idp*sin(p_theta) - l_idp*p_x*sin(p_theta))^2/(l_idp^2*(cos(p_theta)^2 + sin(p_theta)^2)^2))*(cos(p_theta)^2 + sin(p_theta)^2)^2)];

C = [ -(((l_idp*sin(p_theta))/(cos(l_theta)*cos(p_theta) + sin(l_theta)*sin(p_theta) + an_x*l_idp*cos(p_theta) - l_idp*p_x*cos(p_theta) + an_y*l_idp*sin(p_theta) - l_idp*p_y*sin(p_theta)) - (l_idp*cos(p_theta)*(cos(l_theta)*sin(p_theta) - cos(p_theta)*sin(l_theta) - an_y*l_idp*cos(p_theta) + l_idp*p_y*cos(p_theta) + an_x*l_idp*sin(p_theta) - l_idp*p_x*sin(p_theta)))/(cos(l_theta)*cos(p_theta) + sin(l_theta)*sin(p_theta) + an_x*l_idp*cos(p_theta) - l_idp*p_x*cos(p_theta) + an_y*l_idp*sin(p_theta) - l_idp*p_y*sin(p_theta))^2)*(cos(l_theta)*cos(p_theta) + sin(l_theta)*sin(p_theta) + an_x*l_idp*cos(p_theta) - l_idp*p_x*cos(p_theta) + an_y*l_idp*sin(p_theta) - l_idp*p_y*sin(p_theta))^2)/(l_idp^2*((cos(l_theta)*cos(p_theta) + sin(l_theta)*sin(p_theta) + an_x*l_idp*cos(p_theta) - l_idp*p_x*cos(p_theta) + an_y*l_idp*sin(p_theta) - l_idp*p_y*sin(p_theta))^2/(l_idp^2*(cos(p_theta)^2 + sin(p_theta)^2)^2) + (cos(l_theta)*sin(p_theta) - cos(p_theta)*sin(l_theta) - an_y*l_idp*cos(p_theta) + l_idp*p_y*cos(p_theta) + an_x*l_idp*sin(p_theta) - l_idp*p_x*sin(p_theta))^2/(l_idp^2*(cos(p_theta)^2 + sin(p_theta)^2)^2))*(cos(p_theta)^2 + sin(p_theta)^2)^2), (((l_idp*cos(p_theta))/(cos(l_theta)*cos(p_theta) + sin(l_theta)*sin(p_theta) + an_x*l_idp*cos(p_theta) - l_idp*p_x*cos(p_theta) + an_y*l_idp*sin(p_theta) - l_idp*p_y*sin(p_theta)) + (l_idp*sin(p_theta)*(cos(l_theta)*sin(p_theta) - cos(p_theta)*sin(l_theta) - an_y*l_idp*cos(p_theta) + l_idp*p_y*cos(p_theta) + an_x*l_idp*sin(p_theta) - l_idp*p_x*sin(p_theta)))/(cos(l_theta)*cos(p_theta) + sin(l_theta)*sin(p_theta) + an_x*l_idp*cos(p_theta) - l_idp*p_x*cos(p_theta) + an_y*l_idp*sin(p_theta) - l_idp*p_y*sin(p_theta))^2)*(cos(l_theta)*cos(p_theta) + sin(l_theta)*sin(p_theta) + an_x*l_idp*cos(p_theta) - l_idp*p_x*cos(p_theta) + an_y*l_idp*sin(p_theta) - l_idp*p_y*sin(p_theta))^2)/(l_idp^2*((cos(l_theta)*cos(p_theta) + sin(l_theta)*sin(p_theta) + an_x*l_idp*cos(p_theta) - l_idp*p_x*cos(p_theta) + an_y*l_idp*sin(p_theta) - l_idp*p_y*sin(p_theta))^2/(l_idp^2*(cos(p_theta)^2 + sin(p_theta)^2)^2) + (cos(l_theta)*sin(p_theta) - cos(p_theta)*sin(l_theta) - an_y*l_idp*cos(p_theta) + l_idp*p_y*cos(p_theta) + an_x*l_idp*sin(p_theta) - l_idp*p_x*sin(p_theta))^2/(l_idp^2*(cos(p_theta)^2 + sin(p_theta)^2)^2))*(cos(p_theta)^2 + sin(p_theta)^2)^2), 0];
end