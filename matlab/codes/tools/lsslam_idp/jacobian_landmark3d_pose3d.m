function [A,B,C] = jacobian_landmark3d_pose3d(x,l,anchor)

p_x = x(1);
p_y = x(2);
p_z = x(3);
p_qr = x(4);
p_qx = x(5);
p_qy = x(6);
p_qz = x(7);

l_azim = l(1);
l_elev = l(2);
l_idp = l(3);

an_x = anchor(1);
an_y = anchor(2);
an_z = anchor(3);

A = [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           -((((cos(l_azim)*cos(l_elev)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2))/l_idp + (cos(l_elev)*sin(l_azim)*(2*p_qr*p_qz - 2*p_qx*p_qy))/l_idp)/((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy)) - (((cos(l_elev)*sin(l_azim)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2))/l_idp - (cos(l_azim)*cos(l_elev)*(2*p_qr*p_qz + 2*p_qx*p_qy))/l_idp)*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy)))/((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)/(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    -((((cos(l_elev)*(2*p_qr*p_qx + 2*p_qy*p_qz))/l_idp - (sin(l_azim)*sin(l_elev)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2))/l_idp + (cos(l_azim)*sin(l_elev)*(2*p_qr*p_qz - 2*p_qx*p_qy))/l_idp)/((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy)) - (((cos(l_elev)*(2*p_qr*p_qy - 2*p_qx*p_qz))/l_idp + (cos(l_azim)*sin(l_elev)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2))/l_idp + (sin(l_azim)*sin(l_elev)*(2*p_qr*p_qz + 2*p_qx*p_qy))/l_idp)*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy)))/((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)/(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ((((sin(l_elev)*(2*p_qr*p_qx + 2*p_qy*p_qz))/l_idp^2 + (cos(l_elev)*sin(l_azim)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2))/l_idp^2 - (cos(l_azim)*cos(l_elev)*(2*p_qr*p_qz - 2*p_qx*p_qy))/l_idp^2)/((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy)) + (((cos(l_azim)*cos(l_elev)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2))/l_idp^2 - (sin(l_elev)*(2*p_qr*p_qy - 2*p_qx*p_qz))/l_idp^2 + (cos(l_elev)*sin(l_azim)*(2*p_qr*p_qz + 2*p_qx*p_qy))/l_idp^2)*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy)))/((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)/(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2);...
    -((((cos(l_azim)*cos(l_elev)*(2*p_qr*p_qx - 2*p_qy*p_qz))/l_idp + (cos(l_elev)*sin(l_azim)*(2*p_qr*p_qy + 2*p_qx*p_qz))/l_idp)/(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)^(1/2) - ((2*((cos(l_azim)*cos(l_elev)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2))/l_idp + (cos(l_elev)*sin(l_azim)*(2*p_qr*p_qz - 2*p_qx*p_qy))/l_idp)*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy)) + 2*((cos(l_elev)*sin(l_azim)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2))/l_idp - (cos(l_azim)*cos(l_elev)*(2*p_qr*p_qz + 2*p_qx*p_qy))/l_idp)*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy)))*(p_z*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) - (an_z + sin(l_elev)/l_idp)*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) + p_x*(2*p_qr*p_qy + 2*p_qx*p_qz) - p_y*(2*p_qr*p_qx - 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qy + 2*p_qx*p_qz) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qx - 2*p_qy*p_qz)))/(2*(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)^(3/2)))*(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2))/(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2 + (p_z*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) - (an_z + sin(l_elev)/l_idp)*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) + p_x*(2*p_qr*p_qy + 2*p_qx*p_qz) - p_y*(2*p_qr*p_qx - 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qy + 2*p_qx*p_qz) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qx - 2*p_qy*p_qz))^2), ((((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)*(((cos(l_elev)*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2))/l_idp - (cos(l_azim)*sin(l_elev)*(2*p_qr*p_qy + 2*p_qx*p_qz))/l_idp + (sin(l_azim)*sin(l_elev)*(2*p_qr*p_qx - 2*p_qy*p_qz))/l_idp)/(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)^(1/2) + ((2*((cos(l_elev)*(2*p_qr*p_qy - 2*p_qx*p_qz))/l_idp + (cos(l_azim)*sin(l_elev)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2))/l_idp + (sin(l_azim)*sin(l_elev)*(2*p_qr*p_qz + 2*p_qx*p_qy))/l_idp)*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy)) + 2*((cos(l_elev)*(2*p_qr*p_qx + 2*p_qy*p_qz))/l_idp - (sin(l_azim)*sin(l_elev)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2))/l_idp + (cos(l_azim)*sin(l_elev)*(2*p_qr*p_qz - 2*p_qx*p_qy))/l_idp)*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy)))*(p_z*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) - (an_z + sin(l_elev)/l_idp)*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) + p_x*(2*p_qr*p_qy + 2*p_qx*p_qz) - p_y*(2*p_qr*p_qx - 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qy + 2*p_qx*p_qz) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qx - 2*p_qy*p_qz)))/(2*(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)^(3/2))))/(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2 + (p_z*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) - (an_z + sin(l_elev)/l_idp)*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) + p_x*(2*p_qr*p_qy + 2*p_qx*p_qz) - p_y*(2*p_qr*p_qx - 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qy + 2*p_qx*p_qz) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qx - 2*p_qy*p_qz))^2), -((((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)*(((sin(l_elev)*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2))/l_idp^2 + (cos(l_azim)*cos(l_elev)*(2*p_qr*p_qy + 2*p_qx*p_qz))/l_idp^2 - (cos(l_elev)*sin(l_azim)*(2*p_qr*p_qx - 2*p_qy*p_qz))/l_idp^2)/(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)^(1/2) + ((2*((sin(l_elev)*(2*p_qr*p_qx + 2*p_qy*p_qz))/l_idp^2 + (cos(l_elev)*sin(l_azim)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2))/l_idp^2 - (cos(l_azim)*cos(l_elev)*(2*p_qr*p_qz - 2*p_qx*p_qy))/l_idp^2)*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy)) - 2*((cos(l_azim)*cos(l_elev)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2))/l_idp^2 - (sin(l_elev)*(2*p_qr*p_qy - 2*p_qx*p_qz))/l_idp^2 + (cos(l_elev)*sin(l_azim)*(2*p_qr*p_qz + 2*p_qx*p_qy))/l_idp^2)*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy)))*(p_z*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) - (an_z + sin(l_elev)/l_idp)*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) + p_x*(2*p_qr*p_qy + 2*p_qx*p_qz) - p_y*(2*p_qr*p_qx - 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qy + 2*p_qx*p_qz) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qx - 2*p_qy*p_qz)))/(2*(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)^(3/2))))/(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2 + (p_z*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) - (an_z + sin(l_elev)/l_idp)*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) + p_x*(2*p_qr*p_qy + 2*p_qx*p_qz) - p_y*(2*p_qr*p_qx - 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qy + 2*p_qx*p_qz) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qx - 2*p_qy*p_qz))^2)];
 
B = [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           -(((2*p_qr*p_qz - 2*p_qx*p_qy)/((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy)) - ((p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2)*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy)))/((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)/(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           (((p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2)/((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy)) + ((2*p_qr*p_qz + 2*p_qx*p_qy)*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy)))/((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)/(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    (((2*p_qr*p_qx + 2*p_qy*p_qz)/((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy)) - ((2*p_qr*p_qy - 2*p_qx*p_qz)*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy)))/((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)/(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              -(((2*p_qz*p_x - 2*p_qr*p_y - 2*p_qx*p_z - 2*p_qz*(an_x + (cos(l_azim)*cos(l_elev))/l_idp) + 2*p_qr*(an_y + (cos(l_elev)*sin(l_azim))/l_idp) + 2*p_qx*(an_z + sin(l_elev)/l_idp))/((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy)) - (((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))*(2*p_qr*p_x + 2*p_qz*p_y - 2*p_qy*p_z - 2*p_qr*(an_x + (cos(l_azim)*cos(l_elev))/l_idp) - 2*p_qz*(an_y + (cos(l_elev)*sin(l_azim))/l_idp) + 2*p_qy*(an_z + sin(l_elev)/l_idp)))/((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)/(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               (((2*p_qy*p_x - 2*p_qx*p_y + 2*p_qr*p_z - 2*p_qy*(an_x + (cos(l_azim)*cos(l_elev))/l_idp) + 2*p_qx*(an_y + (cos(l_elev)*sin(l_azim))/l_idp) - 2*p_qr*(an_z + sin(l_elev)/l_idp))/((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy)) + (((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))*(2*p_qx*p_x + 2*p_qy*p_y + 2*p_qz*p_z - 2*p_qx*(an_x + (cos(l_azim)*cos(l_elev))/l_idp) - 2*p_qy*(an_y + (cos(l_elev)*sin(l_azim))/l_idp) - 2*p_qz*(an_z + sin(l_elev)/l_idp)))/((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)/(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               (((2*p_qx*p_x + 2*p_qy*p_y + 2*p_qz*p_z - 2*p_qx*(an_x + (cos(l_azim)*cos(l_elev))/l_idp) - 2*p_qy*(an_y + (cos(l_elev)*sin(l_azim))/l_idp) - 2*p_qz*(an_z + sin(l_elev)/l_idp))/((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy)) - (((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))*(2*p_qy*p_x - 2*p_qx*p_y + 2*p_qr*p_z - 2*p_qy*(an_x + (cos(l_azim)*cos(l_elev))/l_idp) + 2*p_qx*(an_y + (cos(l_elev)*sin(l_azim))/l_idp) - 2*p_qr*(an_z + sin(l_elev)/l_idp)))/((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)/(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              -(((2*p_qr*p_x + 2*p_qz*p_y - 2*p_qy*p_z - 2*p_qr*(an_x + (cos(l_azim)*cos(l_elev))/l_idp) - 2*p_qz*(an_y + (cos(l_elev)*sin(l_azim))/l_idp) + 2*p_qy*(an_z + sin(l_elev)/l_idp))/((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy)) + (((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))*(2*p_qz*p_x - 2*p_qr*p_y - 2*p_qx*p_z - 2*p_qz*(an_x + (cos(l_azim)*cos(l_elev))/l_idp) + 2*p_qr*(an_y + (cos(l_elev)*sin(l_azim))/l_idp) + 2*p_qx*(an_z + sin(l_elev)/l_idp)))/((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)/(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2);...
    -(((2*p_qr*p_qy + 2*p_qx*p_qz)/(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)^(1/2) - ((2*(2*p_qr*p_qz - 2*p_qx*p_qy)*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy)) + 2*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2)*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy)))*(p_z*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) - (an_z + sin(l_elev)/l_idp)*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) + p_x*(2*p_qr*p_qy + 2*p_qx*p_qz) - p_y*(2*p_qr*p_qx - 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qy + 2*p_qx*p_qz) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qx - 2*p_qy*p_qz)))/(2*(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)^(3/2)))*(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2))/(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2 + (p_z*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) - (an_z + sin(l_elev)/l_idp)*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) + p_x*(2*p_qr*p_qy + 2*p_qx*p_qz) - p_y*(2*p_qr*p_qx - 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qy + 2*p_qx*p_qz) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qx - 2*p_qy*p_qz))^2), (((2*p_qr*p_qx - 2*p_qy*p_qz)/(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)^(1/2) + ((2*(2*p_qr*p_qz + 2*p_qx*p_qy)*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy)) - 2*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2)*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy)))*(p_z*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) - (an_z + sin(l_elev)/l_idp)*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) + p_x*(2*p_qr*p_qy + 2*p_qx*p_qz) - p_y*(2*p_qr*p_qx - 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qy + 2*p_qx*p_qz) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qx - 2*p_qy*p_qz)))/(2*(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)^(3/2)))*(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2))/(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2 + (p_z*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) - (an_z + sin(l_elev)/l_idp)*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) + p_x*(2*p_qr*p_qy + 2*p_qx*p_qz) - p_y*(2*p_qr*p_qx - 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qy + 2*p_qx*p_qz) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qx - 2*p_qy*p_qz))^2), -(((p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2)/(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)^(1/2) + ((2*(2*p_qr*p_qx + 2*p_qy*p_qz)*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy)) + 2*(2*p_qr*p_qy - 2*p_qx*p_qz)*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy)))*(p_z*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) - (an_z + sin(l_elev)/l_idp)*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) + p_x*(2*p_qr*p_qy + 2*p_qx*p_qz) - p_y*(2*p_qr*p_qx - 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qy + 2*p_qx*p_qz) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qx - 2*p_qy*p_qz)))/(2*(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)^(3/2)))*(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2))/(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2 + (p_z*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) - (an_z + sin(l_elev)/l_idp)*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) + p_x*(2*p_qr*p_qy + 2*p_qx*p_qz) - p_y*(2*p_qr*p_qx - 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qy + 2*p_qx*p_qz) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qx - 2*p_qy*p_qz))^2), -((((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)*((2*p_qy*p_x - 2*p_qx*p_y + 2*p_qr*p_z - 2*p_qy*(an_x + (cos(l_azim)*cos(l_elev))/l_idp) + 2*p_qx*(an_y + (cos(l_elev)*sin(l_azim))/l_idp) - 2*p_qr*(an_z + sin(l_elev)/l_idp))/(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)^(1/2) - ((2*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))*(2*p_qz*p_x - 2*p_qr*p_y - 2*p_qx*p_z - 2*p_qz*(an_x + (cos(l_azim)*cos(l_elev))/l_idp) + 2*p_qr*(an_y + (cos(l_elev)*sin(l_azim))/l_idp) + 2*p_qx*(an_z + sin(l_elev)/l_idp)) + 2*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))*(2*p_qr*p_x + 2*p_qz*p_y - 2*p_qy*p_z - 2*p_qr*(an_x + (cos(l_azim)*cos(l_elev))/l_idp) - 2*p_qz*(an_y + (cos(l_elev)*sin(l_azim))/l_idp) + 2*p_qy*(an_z + sin(l_elev)/l_idp)))*(p_z*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) - (an_z + sin(l_elev)/l_idp)*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) + p_x*(2*p_qr*p_qy + 2*p_qx*p_qz) - p_y*(2*p_qr*p_qx - 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qy + 2*p_qx*p_qz) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qx - 2*p_qy*p_qz)))/(2*(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)^(3/2))))/(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2 + (p_z*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) - (an_z + sin(l_elev)/l_idp)*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) + p_x*(2*p_qr*p_qy + 2*p_qx*p_qz) - p_y*(2*p_qr*p_qx - 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qy + 2*p_qx*p_qz) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qx - 2*p_qy*p_qz))^2), -((((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)*((2*p_qz*p_x - 2*p_qr*p_y - 2*p_qx*p_z - 2*p_qz*(an_x + (cos(l_azim)*cos(l_elev))/l_idp) + 2*p_qr*(an_y + (cos(l_elev)*sin(l_azim))/l_idp) + 2*p_qx*(an_z + sin(l_elev)/l_idp))/(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)^(1/2) + ((2*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))*(2*p_qy*p_x - 2*p_qx*p_y + 2*p_qr*p_z - 2*p_qy*(an_x + (cos(l_azim)*cos(l_elev))/l_idp) + 2*p_qx*(an_y + (cos(l_elev)*sin(l_azim))/l_idp) - 2*p_qr*(an_z + sin(l_elev)/l_idp)) - 2*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))*(2*p_qx*p_x + 2*p_qy*p_y + 2*p_qz*p_z - 2*p_qx*(an_x + (cos(l_azim)*cos(l_elev))/l_idp) - 2*p_qy*(an_y + (cos(l_elev)*sin(l_azim))/l_idp) - 2*p_qz*(an_z + sin(l_elev)/l_idp)))*(p_z*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) - (an_z + sin(l_elev)/l_idp)*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) + p_x*(2*p_qr*p_qy + 2*p_qx*p_qz) - p_y*(2*p_qr*p_qx - 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qy + 2*p_qx*p_qz) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qx - 2*p_qy*p_qz)))/(2*(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)^(3/2))))/(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2 + (p_z*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) - (an_z + sin(l_elev)/l_idp)*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) + p_x*(2*p_qr*p_qy + 2*p_qx*p_qz) - p_y*(2*p_qr*p_qx - 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qy + 2*p_qx*p_qz) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qx - 2*p_qy*p_qz))^2), -((((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)*((2*p_qr*p_x + 2*p_qz*p_y - 2*p_qy*p_z - 2*p_qr*(an_x + (cos(l_azim)*cos(l_elev))/l_idp) - 2*p_qz*(an_y + (cos(l_elev)*sin(l_azim))/l_idp) + 2*p_qy*(an_z + sin(l_elev)/l_idp))/(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)^(1/2) + ((2*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))*(2*p_qy*p_x - 2*p_qx*p_y + 2*p_qr*p_z - 2*p_qy*(an_x + (cos(l_azim)*cos(l_elev))/l_idp) + 2*p_qx*(an_y + (cos(l_elev)*sin(l_azim))/l_idp) - 2*p_qr*(an_z + sin(l_elev)/l_idp)) + 2*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))*(2*p_qx*p_x + 2*p_qy*p_y + 2*p_qz*p_z - 2*p_qx*(an_x + (cos(l_azim)*cos(l_elev))/l_idp) - 2*p_qy*(an_y + (cos(l_elev)*sin(l_azim))/l_idp) - 2*p_qz*(an_z + sin(l_elev)/l_idp)))*(p_z*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) - (an_z + sin(l_elev)/l_idp)*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) + p_x*(2*p_qr*p_qy + 2*p_qx*p_qz) - p_y*(2*p_qr*p_qx - 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qy + 2*p_qx*p_qz) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qx - 2*p_qy*p_qz)))/(2*(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)^(3/2))))/(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2 + (p_z*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) - (an_z + sin(l_elev)/l_idp)*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) + p_x*(2*p_qr*p_qy + 2*p_qx*p_qz) - p_y*(2*p_qr*p_qx - 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qy + 2*p_qx*p_qz) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qx - 2*p_qy*p_qz))^2), -((((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)*((2*p_qx*p_x + 2*p_qy*p_y + 2*p_qz*p_z - 2*p_qx*(an_x + (cos(l_azim)*cos(l_elev))/l_idp) - 2*p_qy*(an_y + (cos(l_elev)*sin(l_azim))/l_idp) - 2*p_qz*(an_z + sin(l_elev)/l_idp))/(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)^(1/2) + ((2*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))*(2*p_qz*p_x - 2*p_qr*p_y - 2*p_qx*p_z - 2*p_qz*(an_x + (cos(l_azim)*cos(l_elev))/l_idp) + 2*p_qr*(an_y + (cos(l_elev)*sin(l_azim))/l_idp) + 2*p_qx*(an_z + sin(l_elev)/l_idp)) - 2*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))*(2*p_qr*p_x + 2*p_qz*p_y - 2*p_qy*p_z - 2*p_qr*(an_x + (cos(l_azim)*cos(l_elev))/l_idp) - 2*p_qz*(an_y + (cos(l_elev)*sin(l_azim))/l_idp) + 2*p_qy*(an_z + sin(l_elev)/l_idp)))*(p_z*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) - (an_z + sin(l_elev)/l_idp)*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) + p_x*(2*p_qr*p_qy + 2*p_qx*p_qz) - p_y*(2*p_qr*p_qx - 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qy + 2*p_qx*p_qz) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qx - 2*p_qy*p_qz)))/(2*(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)^(3/2))))/(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2 + (p_z*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) - (an_z + sin(l_elev)/l_idp)*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) + p_x*(2*p_qr*p_qy + 2*p_qx*p_qz) - p_y*(2*p_qr*p_qx - 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qy + 2*p_qx*p_qz) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qx - 2*p_qy*p_qz))^2)];
 
C = [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           (((2*p_qr*p_qz - 2*p_qx*p_qy)/((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy)) - ((p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2)*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy)))/((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)/(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           -(((p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2)/((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy)) + ((2*p_qr*p_qz + 2*p_qx*p_qy)*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy)))/((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)/(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  -(((2*p_qr*p_qx + 2*p_qy*p_qz)/((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy)) - ((2*p_qr*p_qy - 2*p_qx*p_qz)*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy)))/((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)/(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2);...
    (((2*p_qr*p_qy + 2*p_qx*p_qz)/(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)^(1/2) - ((2*(2*p_qr*p_qz - 2*p_qx*p_qy)*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy)) + 2*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2)*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy)))*(p_z*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) - (an_z + sin(l_elev)/l_idp)*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) + p_x*(2*p_qr*p_qy + 2*p_qx*p_qz) - p_y*(2*p_qr*p_qx - 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qy + 2*p_qx*p_qz) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qx - 2*p_qy*p_qz)))/(2*(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)^(3/2)))*(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2))/(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2 + (p_z*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) - (an_z + sin(l_elev)/l_idp)*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) + p_x*(2*p_qr*p_qy + 2*p_qx*p_qz) - p_y*(2*p_qr*p_qx - 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qy + 2*p_qx*p_qz) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qx - 2*p_qy*p_qz))^2), -(((2*p_qr*p_qx - 2*p_qy*p_qz)/(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)^(1/2) + ((2*(2*p_qr*p_qz + 2*p_qx*p_qy)*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy)) - 2*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2)*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy)))*(p_z*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) - (an_z + sin(l_elev)/l_idp)*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) + p_x*(2*p_qr*p_qy + 2*p_qx*p_qz) - p_y*(2*p_qr*p_qx - 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qy + 2*p_qx*p_qz) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qx - 2*p_qy*p_qz)))/(2*(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)^(3/2)))*(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2))/(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2 + (p_z*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) - (an_z + sin(l_elev)/l_idp)*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) + p_x*(2*p_qr*p_qy + 2*p_qx*p_qz) - p_y*(2*p_qr*p_qx - 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qy + 2*p_qx*p_qz) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qx - 2*p_qy*p_qz))^2), (((p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2)/(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)^(1/2) + ((2*(2*p_qr*p_qx + 2*p_qy*p_qz)*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy)) + 2*(2*p_qr*p_qy - 2*p_qx*p_qz)*((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy)))*(p_z*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) - (an_z + sin(l_elev)/l_idp)*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) + p_x*(2*p_qr*p_qy + 2*p_qx*p_qz) - p_y*(2*p_qr*p_qx - 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qy + 2*p_qx*p_qz) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qx - 2*p_qy*p_qz)))/(2*(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2)^(3/2)))*(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2))/(((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qx + 2*p_qy*p_qz) - p_y*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(p_qr^2 - p_qx^2 + p_qy^2 - p_qz^2) + p_x*(2*p_qr*p_qz - 2*p_qx*p_qy) - p_z*(2*p_qr*p_qx + 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qz - 2*p_qx*p_qy))^2 + ((an_z + sin(l_elev)/l_idp)*(2*p_qr*p_qy - 2*p_qx*p_qz) + p_x*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(p_qr^2 + p_qx^2 - p_qy^2 - p_qz^2) + p_y*(2*p_qr*p_qz + 2*p_qx*p_qy) - p_z*(2*p_qr*p_qy - 2*p_qx*p_qz) - (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qz + 2*p_qx*p_qy))^2 + (p_z*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) - (an_z + sin(l_elev)/l_idp)*(p_qr^2 - p_qx^2 - p_qy^2 + p_qz^2) + p_x*(2*p_qr*p_qy + 2*p_qx*p_qz) - p_y*(2*p_qr*p_qx - 2*p_qy*p_qz) - (an_x + (cos(l_azim)*cos(l_elev))/l_idp)*(2*p_qr*p_qy + 2*p_qx*p_qz) + (an_y + (cos(l_elev)*sin(l_azim))/l_idp)*(2*p_qr*p_qx - 2*p_qy*p_qz))^2)];
 

end