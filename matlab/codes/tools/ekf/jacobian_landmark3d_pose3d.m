function [A,B] = jacobian_landmark3d_pose3d(x,l,z)

e_x = x(1);
e_y = x(2);
e_z = x(3);
e_qr = x(4);
e_qx = x(5);
e_qy = x(6);
e_qz = x(7);


e_lx = l(1);
e_ly = l(2);
e_lz = l(3);


m_azi = z(1);
m_ele = z(2);

A = [-(((2*e_qr*e_qz - 2*e_qx*e_qy)/(e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2)) - ((e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2)*(e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2)))/(e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)*(e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)/((e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        (((e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2)/(e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2)) + ((2*e_qr*e_qz + 2*e_qx*e_qy)*(e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2)))/(e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)*(e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)/((e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               (((2*e_qr*e_qx + 2*e_qy*e_qz)/(e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2)) - ((2*e_qr*e_qy - 2*e_qx*e_qz)*(e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2)))/(e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)*(e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)/((e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2);...
     (((2*e_qr*e_qy + 2*e_qx*e_qz)/((e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)^(1/2) - ((2*(2*e_qr*e_qz - 2*e_qx*e_qy)*(e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2)) + 2*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2)*(e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2)))*(e_lx*(2*e_qr*e_qy + 2*e_qx*e_qz) - e_ly*(2*e_qr*e_qx - 2*e_qy*e_qz) - e_x*(2*e_qr*e_qy + 2*e_qx*e_qz) + e_y*(2*e_qr*e_qx - 2*e_qy*e_qz) + e_lz*(e_qr^2 - e_qx^2 - e_qy^2 + e_qz^2) - e_z*(e_qr^2 - e_qx^2 - e_qy^2 + e_qz^2)))/(2*((e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)^(3/2)))*((e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2))/((e_lx*(2*e_qr*e_qy + 2*e_qx*e_qz) - e_ly*(2*e_qr*e_qx - 2*e_qy*e_qz) - e_x*(2*e_qr*e_qy + 2*e_qx*e_qz) + e_y*(2*e_qr*e_qx - 2*e_qy*e_qz) + e_lz*(e_qr^2 - e_qx^2 - e_qy^2 + e_qz^2) - e_z*(e_qr^2 - e_qx^2 - e_qy^2 + e_qz^2))^2 + (e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2), -(((2*e_qr*e_qx - 2*e_qy*e_qz)/((e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)^(1/2) + ((2*(2*e_qr*e_qz + 2*e_qx*e_qy)*(e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2)) - 2*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2)*(e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2)))*(e_lx*(2*e_qr*e_qy + 2*e_qx*e_qz) - e_ly*(2*e_qr*e_qx - 2*e_qy*e_qz) - e_x*(2*e_qr*e_qy + 2*e_qx*e_qz) + e_y*(2*e_qr*e_qx - 2*e_qy*e_qz) + e_lz*(e_qr^2 - e_qx^2 - e_qy^2 + e_qz^2) - e_z*(e_qr^2 - e_qx^2 - e_qy^2 + e_qz^2)))/(2*((e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)^(3/2)))*((e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2))/((e_lx*(2*e_qr*e_qy + 2*e_qx*e_qz) - e_ly*(2*e_qr*e_qx - 2*e_qy*e_qz) - e_x*(2*e_qr*e_qy + 2*e_qx*e_qz) + e_y*(2*e_qr*e_qx - 2*e_qy*e_qz) + e_lz*(e_qr^2 - e_qx^2 - e_qy^2 + e_qz^2) - e_z*(e_qr^2 - e_qx^2 - e_qy^2 + e_qz^2))^2 + (e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2), (((e_qr^2 - e_qx^2 - e_qy^2 + e_qz^2)/((e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)^(1/2) + ((2*(2*e_qr*e_qx + 2*e_qy*e_qz)*(e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2)) + 2*(2*e_qr*e_qy - 2*e_qx*e_qz)*(e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2)))*(e_lx*(2*e_qr*e_qy + 2*e_qx*e_qz) - e_ly*(2*e_qr*e_qx - 2*e_qy*e_qz) - e_x*(2*e_qr*e_qy + 2*e_qx*e_qz) + e_y*(2*e_qr*e_qx - 2*e_qy*e_qz) + e_lz*(e_qr^2 - e_qx^2 - e_qy^2 + e_qz^2) - e_z*(e_qr^2 - e_qx^2 - e_qy^2 + e_qz^2)))/(2*((e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)^(3/2)))*((e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2))/((e_lx*(2*e_qr*e_qy + 2*e_qx*e_qz) - e_ly*(2*e_qr*e_qx - 2*e_qy*e_qz) - e_x*(2*e_qr*e_qy + 2*e_qx*e_qz) + e_y*(2*e_qr*e_qx - 2*e_qy*e_qz) + e_lz*(e_qr^2 - e_qx^2 - e_qy^2 + e_qz^2) - e_z*(e_qr^2 - e_qx^2 - e_qy^2 + e_qz^2))^2 + (e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)];

B = [(((2*e_qr*e_qz - 2*e_qx*e_qy)/(e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2)) - ((e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2)*(e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2)))/(e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)*(e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)/((e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      -(((e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2)/(e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2)) + ((2*e_qr*e_qz + 2*e_qx*e_qy)*(e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2)))/(e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)*(e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)/((e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               -(((2*e_qr*e_qx + 2*e_qy*e_qz)/(e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2)) - ((2*e_qr*e_qy - 2*e_qx*e_qz)*(e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2)))/(e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)*(e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)/((e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            (((2*e_ly*e_qr - 2*e_lx*e_qz + 2*e_lz*e_qx + 2*e_qz*e_x - 2*e_qr*e_y - 2*e_qx*e_z)/(e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2)) + ((e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))*(2*e_lx*e_qr + 2*e_ly*e_qz - 2*e_lz*e_qy - 2*e_qr*e_x - 2*e_qz*e_y + 2*e_qy*e_z))/(e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)*(e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)/((e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             (((2*e_lz*e_qr + 2*e_lx*e_qy - 2*e_ly*e_qx - 2*e_qy*e_x + 2*e_qx*e_y - 2*e_qr*e_z)/(e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2)) + ((e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))*(2*e_lx*e_qx + 2*e_ly*e_qy + 2*e_lz*e_qz - 2*e_qx*e_x - 2*e_qy*e_y - 2*e_qz*e_z))/(e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)*(e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)/((e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            (((2*e_lx*e_qx + 2*e_ly*e_qy + 2*e_lz*e_qz - 2*e_qx*e_x - 2*e_qy*e_y - 2*e_qz*e_z)/(e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2)) - ((e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))*(2*e_lz*e_qr + 2*e_lx*e_qy - 2*e_ly*e_qx - 2*e_qy*e_x + 2*e_qx*e_y - 2*e_qr*e_z))/(e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)*(e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)/((e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           -(((2*e_lx*e_qr + 2*e_ly*e_qz - 2*e_lz*e_qy - 2*e_qr*e_x - 2*e_qz*e_y + 2*e_qy*e_z)/(e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2)) - ((e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))*(2*e_ly*e_qr - 2*e_lx*e_qz + 2*e_lz*e_qx + 2*e_qz*e_x - 2*e_qr*e_y - 2*e_qx*e_z))/(e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)*(e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)/((e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2);...
     -(((2*e_qr*e_qy + 2*e_qx*e_qz)/((e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)^(1/2) - ((2*(2*e_qr*e_qz - 2*e_qx*e_qy)*(e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2)) + 2*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2)*(e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2)))*(e_lx*(2*e_qr*e_qy + 2*e_qx*e_qz) - e_ly*(2*e_qr*e_qx - 2*e_qy*e_qz) - e_x*(2*e_qr*e_qy + 2*e_qx*e_qz) + e_y*(2*e_qr*e_qx - 2*e_qy*e_qz) + e_lz*(e_qr^2 - e_qx^2 - e_qy^2 + e_qz^2) - e_z*(e_qr^2 - e_qx^2 - e_qy^2 + e_qz^2)))/(2*((e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)^(3/2)))*((e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2))/((e_lx*(2*e_qr*e_qy + 2*e_qx*e_qz) - e_ly*(2*e_qr*e_qx - 2*e_qy*e_qz) - e_x*(2*e_qr*e_qy + 2*e_qx*e_qz) + e_y*(2*e_qr*e_qx - 2*e_qy*e_qz) + e_lz*(e_qr^2 - e_qx^2 - e_qy^2 + e_qz^2) - e_z*(e_qr^2 - e_qx^2 - e_qy^2 + e_qz^2))^2 + (e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2), (((2*e_qr*e_qx - 2*e_qy*e_qz)/((e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)^(1/2) + ((2*(2*e_qr*e_qz + 2*e_qx*e_qy)*(e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2)) - 2*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2)*(e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2)))*(e_lx*(2*e_qr*e_qy + 2*e_qx*e_qz) - e_ly*(2*e_qr*e_qx - 2*e_qy*e_qz) - e_x*(2*e_qr*e_qy + 2*e_qx*e_qz) + e_y*(2*e_qr*e_qx - 2*e_qy*e_qz) + e_lz*(e_qr^2 - e_qx^2 - e_qy^2 + e_qz^2) - e_z*(e_qr^2 - e_qx^2 - e_qy^2 + e_qz^2)))/(2*((e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)^(3/2)))*((e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2))/((e_lx*(2*e_qr*e_qy + 2*e_qx*e_qz) - e_ly*(2*e_qr*e_qx - 2*e_qy*e_qz) - e_x*(2*e_qr*e_qy + 2*e_qx*e_qz) + e_y*(2*e_qr*e_qx - 2*e_qy*e_qz) + e_lz*(e_qr^2 - e_qx^2 - e_qy^2 + e_qz^2) - e_z*(e_qr^2 - e_qx^2 - e_qy^2 + e_qz^2))^2 + (e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2), -(((e_qr^2 - e_qx^2 - e_qy^2 + e_qz^2)/((e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)^(1/2) + ((2*(2*e_qr*e_qx + 2*e_qy*e_qz)*(e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2)) + 2*(2*e_qr*e_qy - 2*e_qx*e_qz)*(e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2)))*(e_lx*(2*e_qr*e_qy + 2*e_qx*e_qz) - e_ly*(2*e_qr*e_qx - 2*e_qy*e_qz) - e_x*(2*e_qr*e_qy + 2*e_qx*e_qz) + e_y*(2*e_qr*e_qx - 2*e_qy*e_qz) + e_lz*(e_qr^2 - e_qx^2 - e_qy^2 + e_qz^2) - e_z*(e_qr^2 - e_qx^2 - e_qy^2 + e_qz^2)))/(2*((e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)^(3/2)))*((e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2))/((e_lx*(2*e_qr*e_qy + 2*e_qx*e_qz) - e_ly*(2*e_qr*e_qx - 2*e_qy*e_qz) - e_x*(2*e_qr*e_qy + 2*e_qx*e_qz) + e_y*(2*e_qr*e_qx - 2*e_qy*e_qz) + e_lz*(e_qr^2 - e_qx^2 - e_qy^2 + e_qz^2) - e_z*(e_qr^2 - e_qx^2 - e_qy^2 + e_qz^2))^2 + (e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2), (((e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)*((2*e_lz*e_qr + 2*e_lx*e_qy - 2*e_ly*e_qx - 2*e_qy*e_x + 2*e_qx*e_y - 2*e_qr*e_z)/((e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)^(1/2) + ((2*(e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))*(2*e_ly*e_qr - 2*e_lx*e_qz + 2*e_lz*e_qx + 2*e_qz*e_x - 2*e_qr*e_y - 2*e_qx*e_z) - 2*(e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))*(2*e_lx*e_qr + 2*e_ly*e_qz - 2*e_lz*e_qy - 2*e_qr*e_x - 2*e_qz*e_y + 2*e_qy*e_z))*(e_lx*(2*e_qr*e_qy + 2*e_qx*e_qz) - e_ly*(2*e_qr*e_qx - 2*e_qy*e_qz) - e_x*(2*e_qr*e_qy + 2*e_qx*e_qz) + e_y*(2*e_qr*e_qx - 2*e_qy*e_qz) + e_lz*(e_qr^2 - e_qx^2 - e_qy^2 + e_qz^2) - e_z*(e_qr^2 - e_qx^2 - e_qy^2 + e_qz^2)))/(2*((e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)^(3/2))))/((e_lx*(2*e_qr*e_qy + 2*e_qx*e_qz) - e_ly*(2*e_qr*e_qx - 2*e_qy*e_qz) - e_x*(2*e_qr*e_qy + 2*e_qx*e_qz) + e_y*(2*e_qr*e_qx - 2*e_qy*e_qz) + e_lz*(e_qr^2 - e_qx^2 - e_qy^2 + e_qz^2) - e_z*(e_qr^2 - e_qx^2 - e_qy^2 + e_qz^2))^2 + (e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2), -(((e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)*((2*e_ly*e_qr - 2*e_lx*e_qz + 2*e_lz*e_qx + 2*e_qz*e_x - 2*e_qr*e_y - 2*e_qx*e_z)/((e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)^(1/2) - ((2*(e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))*(2*e_lz*e_qr + 2*e_lx*e_qy - 2*e_ly*e_qx - 2*e_qy*e_x + 2*e_qx*e_y - 2*e_qr*e_z) - 2*(e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))*(2*e_lx*e_qx + 2*e_ly*e_qy + 2*e_lz*e_qz - 2*e_qx*e_x - 2*e_qy*e_y - 2*e_qz*e_z))*(e_lx*(2*e_qr*e_qy + 2*e_qx*e_qz) - e_ly*(2*e_qr*e_qx - 2*e_qy*e_qz) - e_x*(2*e_qr*e_qy + 2*e_qx*e_qz) + e_y*(2*e_qr*e_qx - 2*e_qy*e_qz) + e_lz*(e_qr^2 - e_qx^2 - e_qy^2 + e_qz^2) - e_z*(e_qr^2 - e_qx^2 - e_qy^2 + e_qz^2)))/(2*((e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)^(3/2))))/((e_lx*(2*e_qr*e_qy + 2*e_qx*e_qz) - e_ly*(2*e_qr*e_qx - 2*e_qy*e_qz) - e_x*(2*e_qr*e_qy + 2*e_qx*e_qz) + e_y*(2*e_qr*e_qx - 2*e_qy*e_qz) + e_lz*(e_qr^2 - e_qx^2 - e_qy^2 + e_qz^2) - e_z*(e_qr^2 - e_qx^2 - e_qy^2 + e_qz^2))^2 + (e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2), (((e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)*((2*e_lx*e_qr + 2*e_ly*e_qz - 2*e_lz*e_qy - 2*e_qr*e_x - 2*e_qz*e_y + 2*e_qy*e_z)/((e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)^(1/2) + ((2*(e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))*(2*e_lz*e_qr + 2*e_lx*e_qy - 2*e_ly*e_qx - 2*e_qy*e_x + 2*e_qx*e_y - 2*e_qr*e_z) + 2*(e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))*(2*e_lx*e_qx + 2*e_ly*e_qy + 2*e_lz*e_qz - 2*e_qx*e_x - 2*e_qy*e_y - 2*e_qz*e_z))*(e_lx*(2*e_qr*e_qy + 2*e_qx*e_qz) - e_ly*(2*e_qr*e_qx - 2*e_qy*e_qz) - e_x*(2*e_qr*e_qy + 2*e_qx*e_qz) + e_y*(2*e_qr*e_qx - 2*e_qy*e_qz) + e_lz*(e_qr^2 - e_qx^2 - e_qy^2 + e_qz^2) - e_z*(e_qr^2 - e_qx^2 - e_qy^2 + e_qz^2)))/(2*((e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)^(3/2))))/((e_lx*(2*e_qr*e_qy + 2*e_qx*e_qz) - e_ly*(2*e_qr*e_qx - 2*e_qy*e_qz) - e_x*(2*e_qr*e_qy + 2*e_qx*e_qz) + e_y*(2*e_qr*e_qx - 2*e_qy*e_qz) + e_lz*(e_qr^2 - e_qx^2 - e_qy^2 + e_qz^2) - e_z*(e_qr^2 - e_qx^2 - e_qy^2 + e_qz^2))^2 + (e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2), (((e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)*((2*e_lx*e_qx + 2*e_ly*e_qy + 2*e_lz*e_qz - 2*e_qx*e_x - 2*e_qy*e_y - 2*e_qz*e_z)/((e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)^(1/2) - ((2*(e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))*(2*e_ly*e_qr - 2*e_lx*e_qz + 2*e_lz*e_qx + 2*e_qz*e_x - 2*e_qr*e_y - 2*e_qx*e_z) + 2*(e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))*(2*e_lx*e_qr + 2*e_ly*e_qz - 2*e_lz*e_qy - 2*e_qr*e_x - 2*e_qz*e_y + 2*e_qy*e_z))*(e_lx*(2*e_qr*e_qy + 2*e_qx*e_qz) - e_ly*(2*e_qr*e_qx - 2*e_qy*e_qz) - e_x*(2*e_qr*e_qy + 2*e_qx*e_qz) + e_y*(2*e_qr*e_qx - 2*e_qy*e_qz) + e_lz*(e_qr^2 - e_qx^2 - e_qy^2 + e_qz^2) - e_z*(e_qr^2 - e_qx^2 - e_qy^2 + e_qz^2)))/(2*((e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)^(3/2))))/((e_lx*(2*e_qr*e_qy + 2*e_qx*e_qz) - e_ly*(2*e_qr*e_qx - 2*e_qy*e_qz) - e_x*(2*e_qr*e_qy + 2*e_qx*e_qz) + e_y*(2*e_qr*e_qx - 2*e_qy*e_qz) + e_lz*(e_qr^2 - e_qx^2 - e_qy^2 + e_qz^2) - e_z*(e_qr^2 - e_qx^2 - e_qy^2 + e_qz^2))^2 + (e_lx*(2*e_qr*e_qz - 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_x*(2*e_qr*e_qz - 2*e_qx*e_qy) + e_z*(2*e_qr*e_qx + 2*e_qy*e_qz) - e_ly*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2) + e_y*(e_qr^2 - e_qx^2 + e_qy^2 - e_qz^2))^2 + (e_ly*(2*e_qr*e_qz + 2*e_qx*e_qy) - e_lz*(2*e_qr*e_qy - 2*e_qx*e_qz) - e_y*(2*e_qr*e_qz + 2*e_qx*e_qy) + e_z*(2*e_qr*e_qy - 2*e_qx*e_qz) + e_lx*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2) - e_x*(e_qr^2 + e_qx^2 - e_qy^2 - e_qz^2))^2)];