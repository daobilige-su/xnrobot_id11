function J=ekf_3d_jacobian_update(mu,lm)

mu_x = mu(1);
mu_y = mu(2);
mu_z = mu(3);
mu_qr = mu(4);
mu_qx = mu(5);
mu_qy = mu(6);
mu_qz = mu(7);

lm_x = lm(1);
lm_y = lm(2);
lm_z = lm(3);

A = ...
    [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          (((2*mu_qr*mu_qz - 2*mu_qx*mu_qy)/(lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz)) + ((mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2)*(lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz)))/(lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2)*(lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2)/((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            -(((mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2)/(lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz)) - ((2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*(lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz)))/(lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2)*(lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2)/((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     -(((2*mu_qr*mu_qx + 2*mu_qy*mu_qz)/(lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz)) + ((2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*(lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz)))/(lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2)*(lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2)/((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       (((2*lm_y*mu_qr - 2*lm_x*mu_qz + 2*lm_z*mu_qx - 2*mu_y*mu_qr + 2*mu_x*mu_qz - 2*mu_z*mu_qx)/(lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz)) - ((lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))*(2*lm_x*mu_qr + 2*lm_y*mu_qz - 2*lm_z*mu_qy - 2*mu_x*mu_qr - 2*mu_y*mu_qz + 2*mu_z*mu_qy))/(lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2)*(lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2)/((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        (((2*lm_z*mu_qr + 2*lm_x*mu_qy - 2*lm_y*mu_qx - 2*mu_z*mu_qr - 2*mu_x*mu_qy + 2*mu_y*mu_qx)/(lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz)) - ((lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))*(2*lm_x*mu_qx + 2*lm_y*mu_qy + 2*lm_z*mu_qz - 2*mu_x*mu_qx - 2*mu_y*mu_qy - 2*mu_z*mu_qz))/(lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2)*(lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2)/((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       (((2*lm_x*mu_qx + 2*lm_y*mu_qy + 2*lm_z*mu_qz - 2*mu_x*mu_qx - 2*mu_y*mu_qy - 2*mu_z*mu_qz)/(lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz)) + ((lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))*(2*lm_z*mu_qr + 2*lm_x*mu_qy - 2*lm_y*mu_qx - 2*mu_z*mu_qr - 2*mu_x*mu_qy + 2*mu_y*mu_qx))/(lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2)*(lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2)/((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      -(((2*lm_x*mu_qr + 2*lm_y*mu_qz - 2*lm_z*mu_qy - 2*mu_x*mu_qr - 2*mu_y*mu_qz + 2*mu_z*mu_qy)/(lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz)) + ((lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))*(2*lm_y*mu_qr - 2*lm_x*mu_qz + 2*lm_z*mu_qx - 2*mu_y*mu_qr + 2*mu_x*mu_qz - 2*mu_z*mu_qx))/(lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2)*(lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2)/((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2);...
    -(((2*mu_qr*mu_qy + 2*mu_qx*mu_qz)/((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2)^(1/2) + ((2*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy)*(lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz)) - 2*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2)*(lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz)))*(lm_z*(mu_qr^2 - mu_qx^2 - mu_qy^2 + mu_qz^2) - mu_z*(mu_qr^2 - mu_qx^2 - mu_qy^2 + mu_qz^2) + lm_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) - lm_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz) - mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) + mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)))/(2*((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2)^(3/2)))*((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2))/((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2 + (lm_z*(mu_qr^2 - mu_qx^2 - mu_qy^2 + mu_qz^2) - mu_z*(mu_qr^2 - mu_qx^2 - mu_qy^2 + mu_qz^2) + lm_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) - lm_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz) - mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) + mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz))^2), (((2*mu_qr*mu_qx - 2*mu_qy*mu_qz)/((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2)^(1/2) + ((2*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*(lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz)) + 2*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2)*(lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz)))*(lm_z*(mu_qr^2 - mu_qx^2 - mu_qy^2 + mu_qz^2) - mu_z*(mu_qr^2 - mu_qx^2 - mu_qy^2 + mu_qz^2) + lm_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) - lm_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz) - mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) + mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)))/(2*((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2)^(3/2)))*((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2))/((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2 + (lm_z*(mu_qr^2 - mu_qx^2 - mu_qy^2 + mu_qz^2) - mu_z*(mu_qr^2 - mu_qx^2 - mu_qy^2 + mu_qz^2) + lm_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) - lm_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz) - mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) + mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz))^2), -(((mu_qr^2 - mu_qx^2 - mu_qy^2 + mu_qz^2)/((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2)^(1/2) - ((2*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz)*(lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz)) - 2*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*(lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz)))*(lm_z*(mu_qr^2 - mu_qx^2 - mu_qy^2 + mu_qz^2) - mu_z*(mu_qr^2 - mu_qx^2 - mu_qy^2 + mu_qz^2) + lm_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) - lm_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz) - mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) + mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)))/(2*((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2)^(3/2)))*((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2))/((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2 + (lm_z*(mu_qr^2 - mu_qx^2 - mu_qy^2 + mu_qz^2) - mu_z*(mu_qr^2 - mu_qx^2 - mu_qy^2 + mu_qz^2) + lm_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) - lm_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz) - mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) + mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz))^2), (((2*lm_z*mu_qr + 2*lm_x*mu_qy - 2*lm_y*mu_qx - 2*mu_z*mu_qr - 2*mu_x*mu_qy + 2*mu_y*mu_qx)/((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2)^(1/2) - ((2*(lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))*(2*lm_y*mu_qr - 2*lm_x*mu_qz + 2*lm_z*mu_qx - 2*mu_y*mu_qr + 2*mu_x*mu_qz - 2*mu_z*mu_qx) + 2*(lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))*(2*lm_x*mu_qr + 2*lm_y*mu_qz - 2*lm_z*mu_qy - 2*mu_x*mu_qr - 2*mu_y*mu_qz + 2*mu_z*mu_qy))*(lm_z*(mu_qr^2 - mu_qx^2 - mu_qy^2 + mu_qz^2) - mu_z*(mu_qr^2 - mu_qx^2 - mu_qy^2 + mu_qz^2) + lm_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) - lm_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz) - mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) + mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)))/(2*((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2)^(3/2)))*((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2))/((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2 + (lm_z*(mu_qr^2 - mu_qx^2 - mu_qy^2 + mu_qz^2) - mu_z*(mu_qr^2 - mu_qx^2 - mu_qy^2 + mu_qz^2) + lm_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) - lm_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz) - mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) + mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz))^2), -(((2*lm_y*mu_qr - 2*lm_x*mu_qz + 2*lm_z*mu_qx - 2*mu_y*mu_qr + 2*mu_x*mu_qz - 2*mu_z*mu_qx)/((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2)^(1/2) + ((2*(lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))*(2*lm_z*mu_qr + 2*lm_x*mu_qy - 2*lm_y*mu_qx - 2*mu_z*mu_qr - 2*mu_x*mu_qy + 2*mu_y*mu_qx) + 2*(lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))*(2*lm_x*mu_qx + 2*lm_y*mu_qy + 2*lm_z*mu_qz - 2*mu_x*mu_qx - 2*mu_y*mu_qy - 2*mu_z*mu_qz))*(lm_z*(mu_qr^2 - mu_qx^2 - mu_qy^2 + mu_qz^2) - mu_z*(mu_qr^2 - mu_qx^2 - mu_qy^2 + mu_qz^2) + lm_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) - lm_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz) - mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) + mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)))/(2*((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2)^(3/2)))*((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2))/((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2 + (lm_z*(mu_qr^2 - mu_qx^2 - mu_qy^2 + mu_qz^2) - mu_z*(mu_qr^2 - mu_qx^2 - mu_qy^2 + mu_qz^2) + lm_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) - lm_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz) - mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) + mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz))^2), (((2*lm_x*mu_qr + 2*lm_y*mu_qz - 2*lm_z*mu_qy - 2*mu_x*mu_qr - 2*mu_y*mu_qz + 2*mu_z*mu_qy)/((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2)^(1/2) + ((2*(lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))*(2*lm_z*mu_qr + 2*lm_x*mu_qy - 2*lm_y*mu_qx - 2*mu_z*mu_qr - 2*mu_x*mu_qy + 2*mu_y*mu_qx) - 2*(lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))*(2*lm_x*mu_qx + 2*lm_y*mu_qy + 2*lm_z*mu_qz - 2*mu_x*mu_qx - 2*mu_y*mu_qy - 2*mu_z*mu_qz))*(lm_z*(mu_qr^2 - mu_qx^2 - mu_qy^2 + mu_qz^2) - mu_z*(mu_qr^2 - mu_qx^2 - mu_qy^2 + mu_qz^2) + lm_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) - lm_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz) - mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) + mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)))/(2*((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2)^(3/2)))*((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2))/((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2 + (lm_z*(mu_qr^2 - mu_qx^2 - mu_qy^2 + mu_qz^2) - mu_z*(mu_qr^2 - mu_qx^2 - mu_qy^2 + mu_qz^2) + lm_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) - lm_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz) - mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) + mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz))^2), (((2*lm_x*mu_qx + 2*lm_y*mu_qy + 2*lm_z*mu_qz - 2*mu_x*mu_qx - 2*mu_y*mu_qy - 2*mu_z*mu_qz)/((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2)^(1/2) - ((2*(lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))*(2*lm_y*mu_qr - 2*lm_x*mu_qz + 2*lm_z*mu_qx - 2*mu_y*mu_qr + 2*mu_x*mu_qz - 2*mu_z*mu_qx) - 2*(lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))*(2*lm_x*mu_qr + 2*lm_y*mu_qz - 2*lm_z*mu_qy - 2*mu_x*mu_qr - 2*mu_y*mu_qz + 2*mu_z*mu_qy))*(lm_z*(mu_qr^2 - mu_qx^2 - mu_qy^2 + mu_qz^2) - mu_z*(mu_qr^2 - mu_qx^2 - mu_qy^2 + mu_qz^2) + lm_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) - lm_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz) - mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) + mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)))/(2*((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2)^(3/2)))*((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2))/((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2 + (lm_z*(mu_qr^2 - mu_qx^2 - mu_qy^2 + mu_qz^2) - mu_z*(mu_qr^2 - mu_qx^2 - mu_qy^2 + mu_qz^2) + lm_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) - lm_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz) - mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) + mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz))^2)];

B = ...
    [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            -(((2*mu_qr*mu_qz - 2*mu_qx*mu_qy)/(lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz)) + ((mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2)*(lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz)))/(lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2)*(lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2)/((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              (((mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2)/(lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz)) - ((2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*(lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz)))/(lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2)*(lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2)/((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     (((2*mu_qr*mu_qx + 2*mu_qy*mu_qz)/(lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz)) + ((2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*(lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz)))/(lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2)*(lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2)/((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2);...
	 (((2*mu_qr*mu_qy + 2*mu_qx*mu_qz)/((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2)^(1/2) + ((2*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy)*(lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz)) - 2*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2)*(lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz)))*(lm_z*(mu_qr^2 - mu_qx^2 - mu_qy^2 + mu_qz^2) - mu_z*(mu_qr^2 - mu_qx^2 - mu_qy^2 + mu_qz^2) + lm_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) - lm_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz) - mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) + mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)))/(2*((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2)^(3/2)))*((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2))/((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2 + (lm_z*(mu_qr^2 - mu_qx^2 - mu_qy^2 + mu_qz^2) - mu_z*(mu_qr^2 - mu_qx^2 - mu_qy^2 + mu_qz^2) + lm_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) - lm_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz) - mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) + mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz))^2), -(((2*mu_qr*mu_qx - 2*mu_qy*mu_qz)/((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2)^(1/2) + ((2*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy)*(lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz)) + 2*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2)*(lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz)))*(lm_z*(mu_qr^2 - mu_qx^2 - mu_qy^2 + mu_qz^2) - mu_z*(mu_qr^2 - mu_qx^2 - mu_qy^2 + mu_qz^2) + lm_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) - lm_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz) - mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) + mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)))/(2*((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2)^(3/2)))*((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2))/((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2 + (lm_z*(mu_qr^2 - mu_qx^2 - mu_qy^2 + mu_qz^2) - mu_z*(mu_qr^2 - mu_qx^2 - mu_qy^2 + mu_qz^2) + lm_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) - lm_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz) - mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) + mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz))^2), (((mu_qr^2 - mu_qx^2 - mu_qy^2 + mu_qz^2)/((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2)^(1/2) - ((2*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz)*(lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz)) - 2*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz)*(lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz)))*(lm_z*(mu_qr^2 - mu_qx^2 - mu_qy^2 + mu_qz^2) - mu_z*(mu_qr^2 - mu_qx^2 - mu_qy^2 + mu_qz^2) + lm_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) - lm_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz) - mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) + mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz)))/(2*((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2)^(3/2)))*((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2))/((lm_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) - mu_x*(mu_qr^2 + mu_qx^2 - mu_qy^2 - mu_qz^2) + lm_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) - lm_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz) - mu_y*(2*mu_qr*mu_qz + 2*mu_qx*mu_qy) + mu_z*(2*mu_qr*mu_qy - 2*mu_qx*mu_qz))^2 + (lm_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - mu_y*(mu_qr^2 - mu_qx^2 + mu_qy^2 - mu_qz^2) - lm_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) + lm_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz) + mu_x*(2*mu_qr*mu_qz - 2*mu_qx*mu_qy) - mu_z*(2*mu_qr*mu_qx + 2*mu_qy*mu_qz))^2 + (lm_z*(mu_qr^2 - mu_qx^2 - mu_qy^2 + mu_qz^2) - mu_z*(mu_qr^2 - mu_qx^2 - mu_qy^2 + mu_qz^2) + lm_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) - lm_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz) - mu_x*(2*mu_qr*mu_qy + 2*mu_qx*mu_qz) + mu_y*(2*mu_qr*mu_qx - 2*mu_qy*mu_qz))^2)];

J = [A,B];
 
end